ggplot(aes(x=연도, y=경제성장률, group = 국가명, color = is_korea)) +
geom_line() +
geom_point() +
labs(x="", y="경제성장률", title = "주요국가 경제성장률",
subtitle = "2015년부터 2020년 경제성장률(단위: %)",
color = "") +
theme(legend.position = "none") +
geom_label_repel(aes(label = label),
nudge_x = 1,
na.rm = TRUE) +
theme_minimal(base_family = "NanumGothic")
growth_viz_tbl %>%
mutate(연도 = as.integer(연도)) %>%
mutate(label = if_else(연도 == max(연도), as.character(국가명), NA_character_))  %>%
ggplot(aes(x=연도, y=경제성장률, group = 국가명, color = is_korea)) +
geom_line() +
geom_point() +
labs(x="", y="경제성장률", title = "주요국가 경제성장률",
subtitle = "2015년부터 2020년 경제성장률(단위: %)",
color = "") +
theme(legend.position = "none") +
geom_label_repel(aes(label = label),
nudge_x = 1,
na.rm = TRUE,
font_family = "NanumGothic") +
theme_minimal(base_family = "NanumGothic")
growth_viz_tbl %>%
mutate(연도 = as.integer(연도)) %>%
mutate(label = if_else(연도 == max(연도), as.character(국가명), NA_character_))  %>%
ggplot(aes(x=연도, y=경제성장률, group = 국가명, color = is_korea)) +
geom_line() +
geom_point() +
labs(x="", y="경제성장률", title = "주요국가 경제성장률",
subtitle = "2015년부터 2020년 경제성장률(단위: %)",
color = "") +
theme(legend.position = "none") +
geom_label_repel(aes(label = label),
nudge_x = 1,
na.rm = TRUE,
fontfamily = "NanumGothic") +
theme_minimal(base_family = "NanumGothic")
growth_viz_tbl %>%
mutate(연도 = as.integer(연도)) %>%
mutate(label = if_else(연도 == max(연도), as.character(국가명), NA_character_))  %>%
ggplot(aes(x=연도, y=경제성장률, group = 국가명, color = is_korea)) +
geom_line() +
geom_point() +
labs(x="", y="경제성장률", title = "주요국가 경제성장률",
subtitle = "2015년부터 2020년 경제성장률(단위: %)",
color = "") +
theme(legend.position = "none") +
geom_label_repel(aes(label = label),
nudge_x = 1,
na.rm = TRUE,
family = "NanumGothic") +
theme_minimal(base_family = "NanumGothic")
growth_viz_tbl %>%
mutate(연도 = as.integer(연도)) %>%
mutate(label = if_else(연도 == max(연도), as.character(국가명), NA_character_))  %>%
ggplot(aes(x=연도, y=경제성장률, group = 국가명, color = is_korea)) +
geom_line() +
geom_point() +
labs(x="", y="경제성장률", title = "주요국가 경제성장률",
subtitle = "2015년부터 2020년 경제성장률(단위: %)",
color = "") +
geom_label_repel(aes(label = label),
nudge_x = 1,
na.rm = TRUE,
family = "NanumGothic") +
theme_minimal(base_family = "NanumGothic") +
theme(legend.position = "none")
growth_viz_tbl %>%
mutate(연도 = as.integer(연도)) %>%
mutate(label = if_else(연도 == max(연도), as.character(국가명), NA_character_))  %>%
ggplot(aes(x=연도, y=경제성장률, group = 국가명, color = is_korea)) +
geom_line() +
geom_point() +
labs(x="", y="경제성장률", title = "주요국가 경제성장률",
subtitle = "2015년부터 2020년 경제성장률(단위: %)",
color = "") +
geom_label_repel(aes(label = label),
nudge_x = 1,
na.rm = TRUE,
family = "NanumGothic") +
theme_minimal(base_family = "NanumGothic") +
theme(legend.position = "none") +
scale_color_manual(values = c("gray50", "red"))
growth_viz_tbl <- growth_tbl %>%
pivot_longer(-국가, names_to = "연도", values_to = "경제성장률") %>%
mutate(국가명 = case_when(국가 == "Brazil" ~ "브라질",
국가 == "France" ~ "프랑스",
국가 == "Germany" ~ "독일",
국가 == "Italy" ~ "이탈리아",
국가 == "Japan" ~ "일본",
국가 == "Korea, Rep." ~ "대한민국",
국가 == "Sweden" ~ "스웨덴",
국가 == "United Kingdom" ~ "영국",
국가 == "United States" ~ "미국")) %>%
mutate(is_korea = if_else(str_detect(국가명, "(대한민국)|(미국)"), TRUE, FALSE))
growth_viz_tbl %>%
ggplot(aes(x=연도, y=경제성장률, group = 국가명, color = is_korea)) +
geom_line() +
geom_point() +
facet_wrap(~국가명) +
theme_minimal(base_family = "NanumGothic") +
labs(x="", y="경제성장률", title = "주요국가 경제성장률",
subtitle = "2015년부터 2020년 경제성장률(단위: %)",
color = "") +
theme(legend.position = "none") +
scale_color_manual(values = c("gray50", "red"))
growth_viz_tbl %>%
mutate(연도 = as.integer(연도)) %>%
mutate(label = if_else(연도 == max(연도), as.character(국가명), NA_character_))  %>%
ggplot(aes(x=연도, y=경제성장률, group = 국가명, color = is_korea)) +
geom_line() +
geom_point() +
labs(x="", y="경제성장률", title = "주요국가 경제성장률",
subtitle = "2015년부터 2020년 경제성장률(단위: %)",
color = "") +
geom_label_repel(aes(label = label),
nudge_x = 1,
na.rm = TRUE,
family = "NanumGothic") +
theme_minimal(base_family = "NanumGothic") +
theme(legend.position = "none") +
scale_color_manual(values = c("gray50", "red"))
growth_viz_tbl %>%
mutate(연도 = as.integer(연도)) %>%
mutate(label = if_else(연도 == max(연도), as.character(국가명), NA_character_))  %>%
ggplot(aes(x=연도, y=경제성장률, group = 국가명, color = is_korea)) +
geom_line() +
geom_point() +
labs(x="", y="경제성장률", title = "주요국가 경제성장률",
subtitle = "2015년부터 2020년 경제성장률(단위: %)",
color = "") +
geom_label_repel(aes(label = label),
nudge_x = 1,
na.rm = TRUE,
family = "NanumGothic") +
theme_minimal(base_family = "NanumGothic") +
theme(legend.position = "none") +
scale_color_manual(values = c("gray50", "red")) +
scale_x_continuous(limits = 2015:2021)
growth_viz_tbl %>%
mutate(연도 = as.integer(연도)) %>%
mutate(label = if_else(연도 == max(연도), as.character(국가명), NA_character_))  %>%
ggplot(aes(x=연도, y=경제성장률, group = 국가명, color = is_korea)) +
geom_line() +
geom_point() +
labs(x="", y="경제성장률", title = "주요국가 경제성장률",
subtitle = "2015년부터 2020년 경제성장률(단위: %)",
color = "") +
geom_label_repel(aes(label = label),
nudge_x = 1,
na.rm = TRUE,
family = "NanumGothic") +
theme_minimal(base_family = "NanumGothic") +
theme(legend.position = "none") +
scale_color_manual(values = c("gray50", "red")) +
scale_x_continuous(limits = c(2015,2021))
growth_viz_tbl <- growth_tbl %>%
pivot_longer(-국가, names_to = "연도", values_to = "경제성장률") %>%
mutate(국가명 = case_when(국가 == "Brazil" ~ "브라질",
국가 == "France" ~ "프랑스",
국가 == "Germany" ~ "독일",
국가 == "Italy" ~ "이탈리아",
국가 == "Japan" ~ "일본",
국가 == "Korea, Rep." ~ "대한민국",
국가 == "Sweden" ~ "스웨덴",
국가 == "United Kingdom" ~ "영국",
국가 == "United States" ~ "미국")) %>%
mutate(is_korea = case_when(str_detect(국가명, "(대한민국)") ~ "대한민국",
str_detect(국가명, "미국") ~ "미국",
TRUE ~ "기타"))
growth_viz_tbl <- growth_tbl %>%
pivot_longer(-국가, names_to = "연도", values_to = "경제성장률") %>%
mutate(국가명 = case_when(국가 == "Brazil" ~ "브라질",
국가 == "France" ~ "프랑스",
국가 == "Germany" ~ "독일",
국가 == "Italy" ~ "이탈리아",
국가 == "Japan" ~ "일본",
국가 == "Korea, Rep." ~ "대한민국",
국가 == "Sweden" ~ "스웨덴",
국가 == "United Kingdom" ~ "영국",
국가 == "United States" ~ "미국")) %>%
mutate(is_korea = case_when(str_detect(국가명, "(대한민국)") ~ "대한민국",
str_detect(국가명, "미국") ~ "미국",
TRUE ~ "기타"))
growth_viz_tbl %>%
ggplot(aes(x=연도, y=경제성장률, group = 국가명, color = is_korea)) +
geom_line() +
geom_point() +
facet_wrap(~국가명) +
theme_minimal(base_family = "NanumGothic") +
labs(x="", y="경제성장률", title = "주요국가 경제성장률",
subtitle = "2015년부터 2020년 경제성장률(단위: %)",
color = "") +
theme(legend.position = "none") +
scale_color_manual(values = c("gray50", "red"))
growth_viz_tbl %>%
ggplot(aes(x=연도, y=경제성장률, group = 국가명, color = is_korea)) +
geom_line() +
geom_point() +
facet_wrap(~국가명) +
theme_minimal(base_family = "NanumGothic") +
labs(x="", y="경제성장률", title = "주요국가 경제성장률",
subtitle = "2015년부터 2020년 경제성장률(단위: %)",
color = "") +
theme(legend.position = "none") +
scale_color_manual(values = c("gray50", "red", "blue"))
growth_viz_tbl %>%
ggplot(aes(x=연도, y=경제성장률, group = 국가명, color = is_korea)) +
geom_line() +
geom_point() +
facet_wrap(~국가명) +
theme_minimal(base_family = "NanumGothic") +
labs(x="", y="경제성장률", title = "주요국가 경제성장률",
subtitle = "2015년부터 2020년 경제성장률(단위: %)",
color = "") +
theme(legend.position = "none") +
scale_color_manual(values = c("gray50", "blue", "red"))
growth_viz_tbl %>%
mutate(연도 = as.integer(연도)) %>%
mutate(label = if_else(연도 == max(연도), as.character(국가명), NA_character_))  %>%
ggplot(aes(x=연도, y=경제성장률, group = 국가명, color = is_korea)) +
geom_line() +
geom_point() +
labs(x="", y="경제성장률", title = "주요국가 경제성장률",
subtitle = "2015년부터 2020년 경제성장률(단위: %)",
color = "") +
geom_label_repel(aes(label = label),
nudge_x = 1,
na.rm = TRUE,
family = "NanumGothic") +
theme_minimal(base_family = "NanumGothic") +
theme(legend.position = "none") +
scale_color_manual(values = c("gray50", "blue", "red")) +
scale_x_continuous(limits = c(2015,2021))
growth_viz_tbl %>%
mutate(연도 = as.integer(연도)) %>%
mutate(label = if_else(연도 == max(연도), as.character(국가명), NA_character_))  %>%
ggplot(aes(x=연도, y=경제성장률, group = 국가명, color = is_korea)) +
geom_line() +
geom_point() +
labs(x="", y="경제성장률", title = "주요국가 경제성장률",
subtitle = "2015년부터 2020년 경제성장률(단위: %)",
color = "") +
geom_label_repel(aes(label = label),
na.rm = TRUE,
family = "NanumGothic") +
theme_minimal(base_family = "NanumGothic") +
theme(legend.position = "none") +
scale_color_manual(values = c("gray50", "blue", "red")) +
scale_x_continuous(limits = c(2015,2021))
growth_viz_tbl %>%
mutate(연도 = as.integer(연도)) %>%
mutate(label = if_else(연도 == max(연도), as.character(국가명), NA_character_))  %>%
ggplot(aes(x=연도, y=경제성장률, group = 국가명, color = is_korea)) +
geom_line() +
geom_point() +
labs(x="", y="경제성장률", title = "주요국가 경제성장률",
subtitle = "2015년부터 2020년 경제성장률(단위: %)",
color = "") +
geom_label_repel(aes(label = label),
nudge_x = 0.5,
na.rm = TRUE,
family = "NanumGothic") +
theme_minimal(base_family = "NanumGothic") +
theme(legend.position = "none") +
scale_color_manual(values = c("gray50", "blue", "red")) +
scale_x_continuous(limits = c(2015,2021))
growth_viz_tbl %>%
mutate(연도 = as.integer(연도)) %>%
mutate(label = if_else(연도 == max(연도), as.character(국가명), NA_character_))  %>%
ggplot(aes(x=연도, y=경제성장률, group = 국가명, color = is_korea)) +
geom_line() +
geom_point() +
labs(x="", y="경제성장률", title = "코로나19 위기 속 주요국가 경제성장률",
subtitle = "2015년부터 2020년 경제성장률(단위: %)",
color = "") +
geom_label_repel(aes(label = label),
nudge_x = 0.5,
na.rm = TRUE,
family = "NanumGothic") +
theme_minimal(base_family = "NanumGothic") +
theme(legend.position = "none") +
scale_color_manual(values = c("gray50", "blue", "red")) +
scale_x_continuous(limits = c(2015,2021))
growth_viz_tbl %>%
mutate(연도 = as.integer(연도)) %>%
mutate(label = if_else(연도 == max(연도), as.character(국가명), NA_character_))  %>%
ggplot(aes(x=연도, y=경제성장률, group = 국가명, color = is_korea)) +
geom_line() +
geom_point() +
labs(x="", y="경제성장률", title = "코로나19 위기 속 주요국가 경제성장률",
subtitle = "2015년부터 2020년 경제성장률(단위: %)",
color = "") +
geom_label_repel(aes(label = label),
nudge_x = 0.5,
na.rm = TRUE,
family = "NanumGothic") +
theme_minimal(base_family = "NanumGothic") +
theme(legend.position = "none") +
scale_color_manual(values = c("gray50", "blue", "red")) +
scale_x_continuous(limits = c(2015,2021)) +
geom_hline(yintercept = 0, ltype ="1")
growth_viz_tbl %>%
mutate(연도 = as.integer(연도)) %>%
mutate(label = if_else(연도 == max(연도), as.character(국가명), NA_character_))  %>%
ggplot(aes(x=연도, y=경제성장률, group = 국가명, color = is_korea)) +
geom_line() +
geom_point() +
labs(x="", y="경제성장률", title = "코로나19 위기 속 주요국가 경제성장률",
subtitle = "2015년부터 2020년 경제성장률(단위: %)",
color = "") +
geom_label_repel(aes(label = label),
nudge_x = 0.5,
na.rm = TRUE,
family = "NanumGothic") +
theme_minimal(base_family = "NanumGothic") +
theme(legend.position = "none") +
scale_color_manual(values = c("gray50", "blue", "red")) +
scale_x_continuous(limits = c(2015,2021)) +
geom_hline(yintercept = 0, ltype =1)
growth_viz_tbl %>%
mutate(연도 = as.integer(연도)) %>%
mutate(label = if_else(연도 == max(연도), as.character(국가명), NA_character_))  %>%
ggplot(aes(x=연도, y=경제성장률, group = 국가명, color = is_korea)) +
geom_line() +
geom_point() +
labs(x="", y="경제성장률", title = "코로나19 위기 속 주요국가 경제성장률",
subtitle = "2015년부터 2020년 경제성장률(단위: %)",
color = "") +
geom_label_repel(aes(label = label),
nudge_x = 0.5,
na.rm = TRUE,
family = "NanumGothic") +
theme_minimal(base_family = "NanumGothic") +
theme(legend.position = "none") +
scale_color_manual(values = c("gray50", "blue", "red")) +
scale_x_continuous(limits = c(2015,2021)) +
geom_hline(yintercept = 0, linetype =1)
growth_viz_tbl %>%
mutate(연도 = as.integer(연도)) %>%
mutate(label = if_else(연도 == max(연도), as.character(국가명), NA_character_))  %>%
ggplot(aes(x=연도, y=경제성장률, group = 국가명, color = is_korea)) +
geom_line() +
geom_point() +
labs(x="", y="경제성장률", title = "코로나19 위기 속 주요국가 경제성장률",
subtitle = "2015년부터 2020년 경제성장률(단위: %)",
color = "") +
geom_label_repel(aes(label = label),
nudge_x = 0.5,
na.rm = TRUE,
family = "NanumGothic") +
theme_minimal(base_family = "NanumGothic") +
theme(legend.position = "none") +
scale_color_manual(values = c("gray50", "blue", "red")) +
scale_x_continuous(limits = c(2015,2021)) +
geom_hline(yintercept = 0, linetype = 1, color = "gray50")
growth_viz_tbl %>%
mutate(연도 = as.integer(연도)) %>%
mutate(label = if_else(연도 == max(연도), as.character(국가명), NA_character_))  %>%
ggplot(aes(x=연도, y=경제성장률, group = 국가명, color = is_korea)) +
geom_line() +
geom_point() +
labs(x="", y="경제성장률", title = "코로나19 위기 속 주요국가 경제성장률",
subtitle = "2015년부터 2020년 경제성장률(단위: %)",
color = "") +
geom_label_repel(aes(label = label),
nudge_x = 0.5,
na.rm = TRUE,
family = "NanumGothic") +
theme_minimal(base_family = "NanumGothic") +
theme(legend.position = "none") +
scale_color_manual(values = c("gray75", "blue", "red")) +
scale_x_continuous(limits = c(2015,2021)) +
geom_hline(yintercept = 0, linetype = 1, color = "gray50")
growth_viz_tbl %>%
mutate(연도 = as.integer(연도)) %>%
mutate(label = if_else(연도 == max(연도), as.character(국가명), NA_character_))  %>%
ggplot(aes(x=연도, y=경제성장률, group = 국가명, color = is_korea)) +
geom_line() +
geom_point() +
labs(x="", y="경제성장률", title = "코로나19 위기 속 주요국가 경제성장률",
subtitle = "2015년부터 2020년 경제성장률(단위: %)",
color = "") +
geom_label_repel(aes(label = label),
nudge_x = 0.5,
na.rm = TRUE,
family = "NanumGothic") +
theme_minimal(base_family = "NanumGothic") +
theme(legend.position = "none") +
scale_color_manual(values = c("gray75", "blue", "red")) +
scale_x_continuous(limits = c(2015,2021)) +
geom_hline(yintercept = 0, linetype = 2, color = "gray50")
growth_viz_tbl %>%
mutate(연도 = as.integer(연도)) %>%
mutate(label = if_else(연도 == max(연도), as.character(국가명), NA_character_))  %>%
ggplot(aes(x=연도, y=경제성장률, group = 국가명, color = is_korea)) +
geom_line() +
geom_point() +
labs(x="", y="경제성장률", title = "코로나19 위기 속 주요국가 경제성장률",
subtitle = "2015년부터 2020년 경제성장률(단위: %)",
color = "") +
geom_label_repel(aes(label = label),
nudge_x = 0.5,
na.rm = TRUE,
family = "NanumGothic") +
theme_minimal(base_family = "NanumGothic") +
theme(legend.position = "none") +
scale_color_manual(values = c("gray75", "blue", "red")) +
scale_x_continuous(limits = c(2015,2021)) +
geom_hline(yintercept = 0, linetype = 2, color = "gray77")
growth_viz_tbl %>%
mutate(연도 = as.integer(연도)) %>%
mutate(label = if_else(연도 == max(연도), as.character(국가명), NA_character_))  %>%
ggplot(aes(x=연도, y=경제성장률, group = 국가명, color = is_korea)) +
geom_line() +
geom_point() +
labs(x="", y="경제성장률", title = "코로나19 위기 속 주요국가 경제성장률",
subtitle = "2015년부터 2020년 경제성장률(단위: %)",
color = "") +
geom_label_repel(aes(label = label),
nudge_x = 0.5,
na.rm = TRUE,
family = "NanumGothic") +
theme_minimal(base_family = "NanumGothic") +
theme(legend.position = "none") +
scale_color_manual(values = c("gray75", "blue", "red")) +
scale_x_continuous(limits = c(2015,2021)) +
geom_hline(yintercept = 0, linetype = 2, color = "gray37")
growth_viz_tbl %>%
mutate(연도 = as.integer(연도)) %>%
mutate(label = if_else(연도 == max(연도), as.character(국가명), NA_character_))  %>%
ggplot(aes(x=연도, y=경제성장률, group = 국가명, color = is_korea)) +
geom_line() +
geom_point() +
labs(x="", y="경제성장률", title = "코로나19 위기 속 주요국가 경제성장률",
subtitle = "2015년부터 2020년 경제성장률(단위: %)",
color = "") +
geom_label_repel(aes(label = label),
nudge_x = 0.5,
na.rm = TRUE,
family = "NanumGothic") +
theme_minimal(base_family = "NanumGothic") +
theme(legend.position = "none") +
scale_color_manual(values = c("gray75", "blue", "red")) +
scale_x_continuous(limits = c(2015,2021)) +
geom_hline(yintercept = 0, linetype = 3, color = "gray37")
ggsave("fig/covid19-growth.png")
deaths_tbl %>%
ggplot(aes(x = as.integer(month), y=사망자, group = year, color = is_2020)) +
geom_line() +
facet_wrap(~국가명, scales = "fixed") +
scale_x_continuous(limits = c(1,12), breaks = c(2,4,6,8,10)) +
scale_y_continuous(labels = scales::comma) +
scale_color_manual(values = c("gray50", "red")) +
theme_minimal(base_family = "NanumGothic") +
labs(x="", y="사망자", title = "코로나19로 인한 주요국가 월별 사망자수 비교",
subtitle = "2015년부터 2020년 월별 사망자수",
color = "") +
theme(legend.position = "top")
deaths_tbl %>%
ggplot(aes(x = as.integer(month), y=사망자, group = year, color = is_2020)) +
geom_line() +
facet_wrap(~국가명, scales = "free_y") +
scale_x_continuous(limits = c(1,12), breaks = c(2,4,6,8,10)) +
scale_y_continuous(labels = scales::comma) +
scale_color_manual(values = c("gray50", "red")) +
theme_minimal(base_family = "NanumGothic") +
labs(x="", y="사망자", title = "코로나19로 인한 주요국가 월별 사망자수 비교",
subtitle = "2015년부터 2020년 월별 사망자수",
color = "") +
theme(legend.position = "top")
ggsave("fig/covid19-deaths.png")
remotes::install_github("eshom/covid-age-data")
inputDB <- download_covid("inputDB", progress = FALSE)
# remotes::install_github("eshom/covid-age-data")
library(covidAgeData)
inputDB <- download_covid("inputDB", progress = FALSE)
subset_covid(inputDB, Country = "South Korea", Region = "All") %>%
head()
library(tidyverse)
subset_covid(inputDB, Country = "South Korea", Region = "All") %>%
head()
korea_tbl <- subset_covid(inputDB, Country = "South Korea", Region = "All")
korea_tbl
korea_tbl <- subset_covid(inputDB, Country = "South Korea", Region = "All") %>%
as_tibble()
korea_tbl
korea_tbl %>%
janitor::clean_names(.)
korea_tbl %>%
janitor::clean_names(.) %>%
mutate(date = dmy(date))
library(lubridate)
korea_tbl %>%
janitor::clean_names(.) %>%
mutate(date = dmy(date))
korea_tbl %>%
janitor::clean_names(.) %>%
mutate(date = dmy(date)) %>%
glimpse
korea_tbl %>%
janitor::clean_names(.) %>%
mutate(date = dmy(date)) %>%
skimr::skim
korea_tbl %>%
janitor::clean_names(.) %>%
mutate(date = dmy(date)) %>%
skimr::skim(.)
